# Как запускать

Для client.py:
- --server &mdash; ip и порт сервера через двоеточие,
- --session &mdash; некий id сессии, одинаковый для двух клиентов, которые хотят соединиться,
- --name &mdash; имя клиента,
- --bind-ip &mdash; ip клиента (есть автодетект),
- --bind-port &mdash; порт клиента (по умолчанию просим ОС дать любой).

```
python3 rendezvous.py --bind-ip 10.0.0.1 --bind-port 1234
```

Для rendezvous.py:
- --bind-ip &mdash; ip сервера,
- --bind-port &mdash; порт сервера.

```
python3 client.py --server 10.0.0.1:1234 --session dddd --name pc1
```

примеры


# Что происходит в записи трафика

У нас запись ведется на NAT4 - Switch3

Ip:
- pc5 &mdash; 192.168.1.10
- pc6 &mdash; 192.168.2.10
- nat4 &mdash; 10.0.0.2
- nat3 &mdash; 10.0.0.3
- rendezvous &mdash; 10.0.0.1

pc5 регистрируется на сервере, сервер сначала отправляет WAIT &mdash; никто еще не подключился, потом PEER вместе с данными второго клиента.

pc5 начинает посылать punch на private и public endpoint, получает обратный punch от public. При попытке отправить на private возникает пакет ICMP Destination Unreachable, который приходит от rendezvous сервера. Это происходит, потому что пакет доходит до сервера, но от сервера этот адрес недостижим, он существует локальной в своей nat.

pc5 и pc6 оба получают по пакету друг от друга, теперь начинают посылать другой punch, чтобы уведомить друг друга, что все хорошо.

И после этого уже начинается взаимодействие в чате.

Параллельно с этим pc5 периодически посылает серверу KEEPALIVE, чтобы тот не забывал клиента.